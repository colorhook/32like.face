{% set nav = "star" %}
{% set title = "star" %}
{% extends "admin/base.html" %}
{% block head %}
<style>
.panel-heading{padding:0}
.panel-heading a{display:block;padding:10px 15px}
.panel-heading a:hover,.panel-heading a:focus{text-decoration: none}
.fileinput-button {
  position: relative;
  overflow: hidden;
}
.fileinput-button input {
  position: absolute;
  top: 0;
  right: 0;
  margin: 0;
  opacity: 0;
  -ms-filter: 'alpha(opacity=0)';
  font-size: 200px;
  direction: ltr;
  cursor: pointer;
}
.btn-save{margin-left:1em}
.fileinput-input{width:60%}
@media (max-width:600px){
  .fileinput-input{width:60%}
}
</style>
{% endblock %}
{% block body %}
{% if info and info != "" %}
<div class="alert alert-danger alert-dismissible fade in" role="alert">
  <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
  <h4>出错了</h4>
  <p>{{ info }}</p>
</div>
{% endif %}


<!--accordion-->
<div class="panel-group" id="accordion">
  
  <!--basic-->
  <div class="panel panel-default">
    <div class="panel-heading">
      <h4 class="panel-title">
        <a {% if mode == "edit" %}data-toggle="collapse" data-parent="#accordion" href="#collapseBasic"{% endif %}>
          新增star
        </a>
      </h4>
    </div>
    <div id="collapseBasic" class="panel-collapse collapse in">
      <div class="panel-body">
        <form class="form-horizontal" role="form" action="/admin/star/action" method="post">
          <label for="J_m_img"  class="col-sm-2 control-label">图片：</label>
          <div class="col-sm-10 clearfix">
            <input id="J_m_img" class="form-control fileinput-input pull-left" type="text" name="img" value="" placeholder="输入URL或上传"/>
            <button type="submit" class="btn btn-primary pull-left btn-save">保存</button>
            <span class="btn pull-right btn-success fileinput-button" data-input="#J_m_img">
              <i class="glyphicon glyphicon-plus"></i>
              <span>添加图片</span>
              <input type="file" name="files[]" multiple="">
            </span>
          </div>
          <div class="form-group">
            <div class="col-sm-offset-0 col-sm-10" style="text-align:right">
              
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
  

  
</div>

{% endblock %}
{% block script %}
<script>
window.g_uploader = {
  action: '/admin/upload/',
  callback: function(e, response, input){
    if(e){
      return alert('上传失败');
    }
    if(!window.JSON){
      return alert('请使用chrome浏览器');
    }
    try{
      response = JSON.parse(response);
    }catch(e){
      return alert(e.toString());
    }
    if(response.code !== 200){
      return alert(response.message);
    }
    input.val("http://" + location.host + response.img);
  }
}
</script>
<script src="/js/uploader.js"></script>
{% endblock %}